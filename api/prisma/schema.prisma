generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

model Funcao {
  id                  Int             @id @default(autoincrement()) 
  nome_funcao         String          @db.VarChar(50)
  profissionais       Profissional[]
  @@map("funcoes")
}

model Profissional {
  id                  Int             @id @default(autoincrement()) 
  nome                String          @db.VarChar(100)
  idade               Int             
  genero              Genero
  ano_inicio_carreira Int             
  foto                String?
  id_funcao           Int             
  funcao              Funcao          @relation(fields: [id_funcao], references: [id])
  consultas           Consulta[]
  @@map("profissionais")
}

model Paciente {
  id        String   @id @db.VarChar(36) @default(uuid())
  nome      String   @db.VarChar(100)
  email     String   @unique @db.VarChar(100)
  senha     String   @db.Text       // <--- altere para Text
  fone      String   @db.VarChar(20)
  endereco  String   @db.VarChar(255)
  data_nasc DateTime @db.Date
  cpf       String   @unique @db.Char(11)
  created_at DateTime @default(now()) @db.Timestamp(6)
  updated_at DateTime @updatedAt @db.Timestamp(6)
  consultas Consulta[]
  @@map("pacientes")
}


model Consulta {
  id                   Int            @id @default(autoincrement()) 
  id_paciente          String            
  id_profissional      Int            
  data                 DateTime       @db.Date
  hora                 DateTime       @db.Time(6)
  tipo                 String         @db.VarChar(50)
  status               Status         @default(AGENDADA)
  created_at           DateTime       @default(now()) @db.Timestamp(6)
  updated_at           DateTime       @updatedAt @db.Timestamp(6)
  admin_id             Int
  
  paciente             Paciente       @relation(fields: [id_paciente], references: [id])
  profissional         Profissional   @relation(fields: [id_profissional], references: [id])
  admin                Admin          @relation(fields: [admin_id], references: [id])
  @@map("consultas")
}

model Admin {
  id                   Int            @id @default(autoincrement()) 
  nome                 String         @db.VarChar(100)
  email                String         @unique @db.VarChar(100)
  senha                String         @db.VarChar(255)
  consultas            Consulta[]
  @@map("admins")
}

enum Genero {
  MASCULINO
  FEMININO
  OUTRO
}

enum Status {
  AGENDADA
  CONCLUIDA
  CANCELADA
}